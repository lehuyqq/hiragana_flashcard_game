<html lang="ja">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Hiragana Flashcard Game</title>
		<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&family=Noto+Sans+JP:wght@400;700&family=Noto+Serif+JP&display=swap" rel="stylesheet">
		<style>
			:root {
			--bg-color: #f9f9f9;
			--text-color: #000;
			--input-bg: #fff;
			--select-bg: #fff;
			--select-text: #000;
			--card-bg: #ffffff;
			--table-border: #ccc;
			}
			
			body.dark {
			--bg-color: #1e1e1e;
			--text-color: #fff;
			--input-bg: #333;
			--select-bg: #444;
			--select-text: #fff;
			--card-bg: #2f2f2f;
			--table-border: #555;
			}
			
			body {
			font-family: 'Noto Sans', sans-serif;
			background: var(--bg-color);
			color: var(--text-color);
			display: flex;
			flex-direction: column;
			align-items: center;
			margin: 0;
			min-height: 100vh;
			transition: background 0.3s ease, color 0.3s ease;
			}
			
			.top-controls {
			display: flex;
			flex-wrap: wrap;
			justify-content: center;
			gap: 16px;
			margin-top: 20px;
			}
			
			.group-select {
			display: flex;
			align-items: center;
			gap: 8px;
			}
			
			select {
			font-family: 'Noto Sans', sans-serif;
			padding: 10px;
			font-size: 16px;
			border: 1px solid #ccc;
			border-radius: 8px;
			background: var(--select-bg);
			color: var(--select-text);
			}
			
			.dark-mode-toggle, .kana-table-toggle {
			position: fixed;
			top: 16px;
			font-size: 18px;
			background: none;
			border: 1px solid var(--text-color);
			border-radius: 20px;
			padding: 6px 12px;
			cursor: pointer;
			color: inherit;
			transition: background 0.2s;
			}
			
			.dark-mode-toggle {
			right: 16px;
			}
			
			.kana-table-toggle {
			right: 70px;
			}
			
			.main-content {
			display: flex;
			flex-direction: row;
			justify-content: center;
			gap: 20px;
			width: 100%;
			max-width: 1000px;
			margin-top: 30px;
			padding: 0 20px;
			}
			
			.flashcard {
			background: var(--card-bg);
			width: 400px;
			height: 300px;
			margin-top: 60px;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			padding: 20px;
			border-radius: 20px;
			box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
			text-align: center;
			}
			
			.question {
			font-size: 64px;
			margin-bottom: 20px;
			}
			
			.jp-text {
			font-family: 'Meiryo', sans-serif;
			}
			
			.input-mode input {
			padding: 10px;
			font-size: 20px;
			border: 1px solid #ccc;
			border-radius: 8px;
			width: 200px;
			text-align: center;
			background: var(--input-bg);
			color: var(--text-color);
			}
			
			.feedback {
			margin-top: 10px;
			font-size: 20px;
			}
			
			.controls {
			margin-top: 10px;
			display: flex;
			gap: 10px;
			justify-content: center;
			flex-wrap: wrap;
			}
			
			.controls button {
			font-family: 'Noto Sans', sans-serif;
			padding: 10px 16px;
			font-size: 16px;
			border: none;
			background: #007bff;
			color: white;
			border-radius: 8px;
			cursor: pointer;
			}
			
			.controls button:hover {
			background: #0056b3;
			}
			
			.kana-table-container {
			flex-shrink: 0;
			width: 400px;
			max-height: 700px;
			overflow-y: auto;
			background: var(--card-bg);
			padding: 16px;
			border-radius: 10px;
			border: 2px solid var(--table-border);
			display: none;
			}
			
			.kana-table-container table {
			border-collapse: collapse;
			width: 100%;
			font-size: 30px;
			text-align: center;
			}
			
			.kana-table-container th,
			.kana-table-container td {
			border: 1px solid var(--table-border);
			padding: 6px;
			}
			
			.kana-table-container td {
			font-size: 30px;
			}
			.custom-dropdown {
			position: relative;
			display: inline-block;
			}
			
			.dropdown-btn {
			padding: 8px 12px;
			background: var(--select-bg);
			color: var(--select-text);
			border: 1px solid #ccc;
			border-radius: 6px;
			cursor: pointer;
			font-size: 14px;
			}
			
			.dropdown-content {
			display: none;
			position: absolute;
			background-color: var(--card-bg);
			min-width: 200px;
			max-height: 300px;
			overflow-y: auto;
			box-shadow: 0px 2px 8px rgba(0,0,0,0.2);
			padding: 8px;
			border-radius: 8px;
			z-index: 1000;
			}
			
			.dropdown-content label {
			display: block;
			margin-bottom: 4px;
			font-size: 14px;
			}
			
			.custom-dropdown.open .dropdown-content {
			display: block;
			}
			
		</style>
	</head>
	<body>
		<button class="dark-mode-toggle" id="modeToggle" onclick="toggleDarkMode()">üåô</button>
		<button class="kana-table-toggle" onclick="toggleKanaTable()">üìñ</button>
		
		<div class="top-controls">
			<div class="group-select">
				<label>Ch·ªØ th∆∞·ªùng:</label>
				<div class="custom-dropdown">
					<button class="dropdown-btn" onclick="toggleDropdown('groupDropdown')">Nh√≥m ‚ñº</button>
					<div class="dropdown-content" id="groupDropdown">
					    <label><input type="checkbox" name="group" value="all" checked> T·∫•t c·∫£</label>
						<label><input type="checkbox" name="group" value="a"> a - i - u - e - o</label>
						<label><input type="checkbox" name="group" value="ka"> ka - ki - ku - ke - ko</label>
						<label><input type="checkbox" name="group" value="sa"> sa - shi - su - se - so</label>
						<label><input type="checkbox" name="group" value="ta"> ta - chi - tsu - te - to</label>
						<label><input type="checkbox" name="group" value="na"> na - ni - nu - ne - no</label>
						<label><input type="checkbox" name="group" value="ha"> ha - hi - fu - he - ho</label>
						<label><input type="checkbox" name="group" value="ma"> ma - mi - mu - me - mo</label>
						<label><input type="checkbox" name="group" value="ya"> ya - yu - y</label>
						<label><input type="checkbox" name="group" value="ra"> ra - ri - ru - re - ro</label>
						<label><input type="checkbox" name="group" value="wa"> wa - wo - n</label>
						<label><input type="checkbox" name="group" value="none"> Tr·ªëng</label>
					</div>
				</div>
			</div>
			
			<div class="group-select">
				<label>Bi·∫øn √¢m:</label>
				<div class="custom-dropdown">
					<button class="dropdown-btn" onclick="toggleDropdown('voicedDropdown')">Nh√≥m ‚ñº</button>
					<div class="dropdown-content" id="voicedDropdown">
						<label><input type="checkbox" name="voicedGroup" value="all" checked> T·∫•t c·∫£</label>
						<label><input type="checkbox" name="voicedGroup" value="ga"> ga - gi - gu - ge - go</label>
						<label><input type="checkbox" name="voicedGroup" value="za"> za - ji - zu - ze - zo</label>
						<label><input type="checkbox" name="voicedGroup" value="da"> da - ji - zu - de - do</label>
						<label><input type="checkbox" name="voicedGroup" value="ba"> ba - bi - bu - be - bo</label>
						<label><input type="checkbox" name="voicedGroup" value="pa"> pa - pi - pu - pe - po</label>
						<label><input type="checkbox" name="voicedGroup" value="none"> Tr·ªëng</label>
					</div>
				</div>
			</div>
			
			<div class="group-select">
				<label for="mode">Ch·∫ø ƒë·ªô:</label>
				<select id="mode" onchange="selectGroup()">
					<option value="single" selected>Ch·ªØ c√°i</option>
					<option value="compound">T·ª´ gh√©p c√≥ s·∫µn</option>
					<option value="random">T·ª´ gh√©p ng·∫´u nhi√™n</option>
				</select>
			</div>
			
			<div class="group-select">
				<label for="jpFont">Font ti·∫øng Nh·∫≠t:</label>
				<select id="jpFont" onchange="updateJapaneseFont()">
					<option value="'Meiryo', sans-serif">Meiryo</option>
					<option value="'Noto Serif JP', serif">Noto Serif JP</option>
				</select>
			</div>
		</div>
		
		<div class="main-content">
			<div class="flashcard">
				<div class="question jp-text" id="question">Loading...</div>
				<div class="input-mode">
					<input type="text" id="answerInput" placeholder="Nh·∫≠p ƒë√°p √°n..." onkeydown="handleKey(event)" />
				</div>
				<div class="feedback" id="feedback"></div>
				<div class="controls">
					<button onclick="toggleDirection()">
						<span id="dirLabel">Hiragana ‚Üí Romaji</span>
					</button>
					<button onclick="shuffleQuestions()">üîÑ X√°o tr·ªôn</button>
				</div>
			</div>
			
			<div class="kana-table-container" id="kanaTable">
				<table id="kanaTableContent">
					<tr><th></th><th>a</th><th>i</th><th>u</th><th>e</th><th>o</th></tr>
					<tr><td></td><td>„ÅÇ</td><td>„ÅÑ</td><td>„ÅÜ</td><td>„Åà</td><td>„Åä</td></tr>
					<tr><td>k</td><td>„Åã</td><td>„Åç</td><td>„Åè</td><td>„Åë</td><td>„Åì</td></tr>
					<tr><td>g</td><td>„Åå</td><td>„Åé</td><td>„Åê</td><td>„Åí</td><td>„Åî</td></tr>
					<tr><td>s</td><td>„Åï</td><td>„Åó</td><td>„Åô</td><td>„Åõ</td><td>„Åù</td></tr>
					<tr><td>z</td><td>„Åñ</td><td>„Åò</td><td>„Åö</td><td>„Åú</td><td>„Åû</td></tr>
					<tr><td>t</td><td>„Åü</td><td>„Å°</td><td>„Å§</td><td>„Å¶</td><td>„Å®</td></tr>
					<tr><td>d</td><td>„Å†</td><td>„Å¢</td><td>„Å•</td><td>„Åß</td><td>„Å©</td></tr>
					<tr><td>n</td><td>„Å™</td><td>„Å´</td><td>„Å¨</td><td>„Å≠</td><td>„ÅÆ</td></tr>
					<tr><td>h</td><td>„ÅØ</td><td>„Å≤</td><td>„Åµ</td><td>„Å∏</td><td>„Åª</td></tr>
					<tr><td>b</td><td>„Å∞</td><td>„Å≥</td><td>„Å∂</td><td>„Åπ</td><td>„Åº</td></tr>
					<tr><td>p</td><td>„Å±</td><td>„Å¥</td><td>„Å∑</td><td>„Å∫</td><td>„ÅΩ</td></tr>
					<tr><td>m</td><td>„Åæ</td><td>„Åø</td><td>„ÇÄ</td><td>„ÇÅ</td><td>„ÇÇ</td></tr>
					<tr><td>y</td><td>„ÇÑ</td><td></td><td>„ÇÜ</td><td></td><td>„Çà</td></tr>
					<tr><td>r</td><td>„Çâ</td><td>„Çä</td><td>„Çã</td><td>„Çå</td><td>„Çç</td></tr>
					<tr><td>w</td><td>„Çè</td><td></td><td></td><td></td><td>„Çí</td></tr>
					<tr><td>n</td><td colspan="5">„Çì</td></tr>
				</table>
			</div>
		</div>
		
		<script>
			const hiraganaData = [
			{ romaji: "a", hiragana: "„ÅÇ", group: "a" },
			{ romaji: "i", hiragana: "„ÅÑ", group: "a" },
			{ romaji: "u", hiragana: "„ÅÜ", group: "a" },
			{ romaji: "e", hiragana: "„Åà", group: "a" },
			{ romaji: "o", hiragana: "„Åä", group: "a" },
			{ romaji: "ka", hiragana: "„Åã", group: "ka" },
			{ romaji: "ki", hiragana: "„Åç", group: "ka" },
			{ romaji: "ku", hiragana: "„Åè", group: "ka" },
			{ romaji: "ke", hiragana: "„Åë", group: "ka" },
			{ romaji: "ko", hiragana: "„Åì", group: "ka" },
			{ romaji: "sa", hiragana: "„Åï", group: "sa" },
			{ romaji: "shi", hiragana: "„Åó", group: "sa" },
			{ romaji: "su", hiragana: "„Åô", group: "sa" },
			{ romaji: "se", hiragana: "„Åõ", group: "sa" },
			{ romaji: "so", hiragana: "„Åù", group: "sa" },
			{ romaji: "ta", hiragana: "„Åü", group: "ta" },
			{ romaji: "chi", hiragana: "„Å°", group: "ta" },
			{ romaji: "tsu", hiragana: "„Å§", group: "ta" },
			{ romaji: "te", hiragana: "„Å¶", group: "ta" },
			{ romaji: "to", hiragana: "„Å®", group: "ta" },
			{ romaji: "na", hiragana: "„Å™", group: "na" },
			{ romaji: "ni", hiragana: "„Å´", group: "na" },
			{ romaji: "nu", hiragana: "„Å¨", group: "na" },
			{ romaji: "ne", hiragana: "„Å≠", group: "na" },
			{ romaji: "no", hiragana: "„ÅÆ", group: "na" },
			{ romaji: "ha", hiragana: "„ÅØ", group: "ha" },
			{ romaji: "hi", hiragana: "„Å≤", group: "ha" },
			{ romaji: "fu", hiragana: "„Åµ", group: "ha" },
			{ romaji: "he", hiragana: "„Å∏", group: "ha" },
			{ romaji: "ho", hiragana: "„Åª", group: "ha" },
			{ romaji: "ma", hiragana: "„Åæ", group: "ma" },
			{ romaji: "mi", hiragana: "„Åø", group: "ma" },
			{ romaji: "mu", hiragana: "„ÇÄ", group: "ma" },
			{ romaji: "me", hiragana: "„ÇÅ", group: "ma" },
			{ romaji: "mo", hiragana: "„ÇÇ", group: "ma" },
			{ romaji: "ya", hiragana: "„ÇÑ", group: "ya" },
			{ romaji: "yu", hiragana: "„ÇÜ", group: "ya" },
			{ romaji: "yo", hiragana: "„Çà", group: "ya" },
			{ romaji: "ra", hiragana: "„Çâ", group: "ra" },
			{ romaji: "ri", hiragana: "„Çä", group: "ra" },
			{ romaji: "ru", hiragana: "„Çã", group: "ra" },
			{ romaji: "re", hiragana: "„Çå", group: "ra" },
			{ romaji: "ro", hiragana: "„Çç", group: "ra" },
			{ romaji: "wa", hiragana: "„Çè", group: "wa" },
			{ romaji: "wo", hiragana: "„Çí", group: "wa" },
			{ romaji: "n", hiragana: "„Çì", group: "wa" },
			
			{ romaji: "ga", hiragana: "„Åå", group: "ga" },
			{ romaji: "gi", hiragana: "„Åé", group: "ga" },
			{ romaji: "gu", hiragana: "„Åê", group: "ga" },
			{ romaji: "ge", hiragana: "„Åí", group: "ga" },
			{ romaji: "go", hiragana: "„Åî", group: "ga" },
			
			{ romaji: "za", hiragana: "„Åñ", group: "za" },
			{ romaji: "ji", hiragana: "„Åò", group: "za" },
			{ romaji: "zu", hiragana: "„Åö", group: "za" },
			{ romaji: "ze", hiragana: "„Åú", group: "za" },
			{ romaji: "zo", hiragana: "„Åû", group: "za" },
			
			{ romaji: "da", hiragana: "„Å†", group: "da" },
			{ romaji: "ji", hiragana: "„Å¢", group: "da" },
			{ romaji: "zu", hiragana: "„Å•", group: "da" },
			{ romaji: "de", hiragana: "„Åß", group: "da" },
			{ romaji: "do", hiragana: "„Å©", group: "da" },
			
			{ romaji: "ba", hiragana: "„Å∞", group: "ba" },
			{ romaji: "bi", hiragana: "„Å≥", group: "ba" },
			{ romaji: "bu", hiragana: "„Å∂", group: "ba" },
			{ romaji: "be", hiragana: "„Åπ", group: "ba" },
			{ romaji: "bo", hiragana: "„Åº", group: "ba" },
			
			{ romaji: "pa", hiragana: "„Å±", group: "pa" },
			{ romaji: "pi", hiragana: "„Å¥", group: "pa" },
			{ romaji: "pu", hiragana: "„Å∑", group: "pa" },
			{ romaji: "pe", hiragana: "„Å∫", group: "pa" },
			{ romaji: "po", hiragana: "„ÅΩ", group: "pa" },
			];
			
			const rawWords = [
			"arigato", "usagi", "neko", "inu", "sakura", "kumo", "hana", "ame", "yuki", "kaze",
			"natsu", "haru", "aki", "fuyu", "mizu", "umi", "yama", "mori", "hoshi", "sora",
			"hikari", "kokoro", "tomodachi", "ie", "kodomo", "tabemono", "nomimono", "mirai", "asatte", "otona"
			];
			
			const romajiToHiragana = s => {
				for (let { romaji, hiragana } of [...hiraganaData].sort((a, b) => b.romaji.length - a.romaji.length)) {
					s = s.replace(new RegExp(romaji, 'g'), hiragana);
				}
				return s;
			};
			
			const basicRomaji = hiraganaData.map(e => e.romaji);
			
			function isValidWord(word, validRomajiList) {
				const sorted = [...validRomajiList].sort((a, b) => b.length - a.length);
				let i = 0;
				while (i < word.length) {
					let matched = false;
					for (let key of sorted) {
						if (word.slice(i, i + key.length) === key) {
							i += key.length;
							matched = true;
							break;
						}
					}
					if (!matched) return false;
				}
				return true;
			}
			
			const filteredRomajiWords = rawWords.filter(word => isValidWord(word, basicRomaji));
			const compoundWords = filteredRomajiWords.map(word => ({
				romaji: word,
				hiragana: romajiToHiragana(word),
				group: "compound"
			}));
			
			let currentSet = [];
			let unusedIndices = [];
			let currentIndex = 0;
			let modeDirection = "ja2ro";
			
			const questionEl = document.getElementById("question");
			const answerInput = document.getElementById("answerInput");
			const feedbackEl = document.getElementById("feedback");
			const dirLabel = document.getElementById("dirLabel");
			
			function shuffle(array) {
				for (let i = array.length - 1; i > 0; i--) {
					const j = Math.floor(Math.random() * (i + 1));
					[array[i], array[j]] = [array[j], array[i]];
				}
			}
			
			function toggleDirection() {
				modeDirection = modeDirection === "ja2ro" ? "ro2ja" : "ja2ro";
				dirLabel.textContent = modeDirection === "ja2ro" ? "Hiragana ‚Üí Romaji" : "Romaji ‚Üí Hiragana";
				shuffleQuestions();
			}
			
			function selectGroup() {
				const mode = document.getElementById("mode").value;
				const wordLengthContainer = document.getElementById("lengthContainer");
				
				// Hi·ªÉn th·ªã ch·ªçn ƒë·ªô d√†i t·ª´ gh√©p khi ch·ªçn "random"
				if (wordLengthContainer) {
					wordLengthContainer.style.display = mode === "random" ? "inline-block" : "none";
				}
				
				const wordLength = parseInt(document.getElementById("lengthSelect")?.value || "3");
				
				// L·∫•y c√°c nh√≥m ƒë∆∞·ª£c ch·ªçn t·ª´ checkbox
				const selectedGroups = Array.from(document.querySelectorAll('input[name="group"]:checked')).map(cb => cb.value);
				const selectedVoicedGroups = Array.from(document.querySelectorAll('input[name="voicedGroup"]:checked')).map(cb => cb.value);
				
				const baseKana = hiraganaData.filter(e =>
				["a", "ka", "sa", "ta", "na", "ha", "ma", "ya", "ra", "wa"].includes(e.group)
				);
				const voicedKana = hiraganaData.filter(e =>
				["ga", "za", "da", "ba", "pa"].includes(e.group)
				);
				
				const baseFiltered = selectedGroups.includes("all")
				? baseKana
				: baseKana.filter(k => selectedGroups.includes(k.group));
				
				const voicedFiltered = selectedVoicedGroups.includes("all")
				? voicedKana
				: voicedKana.filter(k => selectedVoicedGroups.includes(k.group));
				
				if (mode === "compound") {
					currentSet = [...compoundWords];
					} else if (mode === "random") {
					const all = [...baseFiltered, ...voicedFiltered];
					if (all.length === 0) {
						currentSet = [];
						} else {
						currentSet = Array.from({ length: 50 }, () => {
							const word = Array.from({ length: wordLength }, () =>
							all[Math.floor(Math.random() * all.length)]
							);
							return {
								romaji: word.map(c => c.romaji).join(""),
								hiragana: word.map(c => c.hiragana).join(""),
								group: "random"
							};
						});
					}
					} else {
					currentSet = [...baseFiltered, ...voicedFiltered];
				}
				
				shuffleQuestions();
			}
			
			
			
			
			window.addEventListener("DOMContentLoaded", () => {
				const savedTheme = localStorage.getItem("theme");
				const toggleButton = document.getElementById("modeToggle");
				handleGroupCheckboxLogic("group");
                handleGroupCheckboxLogic("voicedGroup");
				if (savedTheme === "dark") {
					document.body.classList.add("dark");
					toggleButton.textContent = "‚òÄÔ∏è";
					} else {
					toggleButton.textContent = "üåô";
				}
				
				// Th√™m dropdown ƒë·ªô d√†i t·ª´ khi DOM ƒë√£ t·∫£i xong
				const lengthControl = document.createElement("div");
				lengthControl.className = "group-select";
				lengthControl.id = "lengthContainer";
				lengthControl.style.display = "none"; // ·∫®n ban ƒë·∫ßu
				lengthControl.innerHTML = `
				<label for="lengthSelect">ƒê·ªô d√†i t·ª´ gh√©p:</label>
				<select id="lengthSelect" onchange="selectGroup()">
				<option value="2">2 ch·ªØ c√°i</option>
				<option value="3" selected>3 ch·ªØ c√°i</option>
				<option value="4">4 ch·ªØ c√°i</option>
				<option value="5">5 ch·ªØ c√°i</option>
				</select>
				`;
				document.querySelector(".top-controls").appendChild(lengthControl);
				
				
				selectGroup();
			});
			
			
			function loadQuestion() {
				const current = currentSet[currentIndex];
				feedbackEl.textContent = "";
				questionEl.textContent = modeDirection === "ro2ja" ? current.romaji : current.hiragana;
				answerInput.value = "";
				answerInput.focus();
			}
			
			function checkAnswer(input) {
				const current = currentSet[currentIndex];
				const correct = modeDirection === "ro2ja" ? current.hiragana : current.romaji;
				feedbackEl.textContent = input.trim().toLowerCase() === correct ? "‚úÖ ƒê√∫ng r·ªìi!" : `‚ùå Sai, ƒë√∫ng l√†: ${correct}`;
				setTimeout(() => {
					currentIndex = (currentIndex + 1) % currentSet.length;
					nextQuestion();
				}, 1200);
			}
			
			function handleKey(e) {
				if (e.key === "Enter") checkAnswer(answerInput.value);
			}
			
			function nextQuestion() {
				if (unusedIndices.length === 0) {
					unusedIndices = currentSet.map((_, i) => i);
					shuffleQuestions(); // Khi h·∫øt t·ª´ ch∆∞a d√πng, x√°o tr·ªôn l·∫°i
				}
				currentIndex = unusedIndices.pop();
				loadQuestion();
			}
			
			
			function shuffleQuestions() {
				unusedIndices = currentSet.map((_, i) => i);
				shuffle(unusedIndices);
				nextQuestion();
			}
			
			function toggleKanaTable() {
				const table = document.getElementById("kanaTable");
				table.style.display = table.style.display === "block" ? "none" : "block";
			}
			
			function toggleDarkMode() {
				document.body.classList.toggle("dark");
				const isDark = document.body.classList.contains("dark");
				localStorage.setItem("theme", isDark ? "dark" : "light");
				
				const toggleButton = document.getElementById("modeToggle");
				toggleButton.textContent = isDark ? "‚òÄÔ∏è" : "üåô";
			}
			
			
			window.addEventListener("DOMContentLoaded", () => {
				const savedTheme = localStorage.getItem("theme");
				const toggleButton = document.getElementById("modeToggle");
				
				if (savedTheme === "dark") {
					document.body.classList.add("dark");
					toggleButton.textContent = "‚òÄÔ∏è";
					} else {
					toggleButton.textContent = "üåô";
				}
				
				selectGroup();
			});
			
			
			function updateJapaneseFont() {
				const selectedFont = document.getElementById("jpFont").value;
				document.getElementById("question").style.fontFamily = selectedFont;
				document.getElementById("kanaTableContent").style.fontFamily = selectedFont;
			}
			function toggleDropdown(id) {
				// ·∫®n t·∫•t c·∫£ dropdown tr∆∞·ªõc
				document.querySelectorAll('.dropdown-content').forEach(d => {
					if (d.id !== id) d.style.display = 'none';
				});
				
				const dropdown = document.getElementById(id);
				dropdown.style.display = (dropdown.style.display === "block") ? "none" : "block";
			}
			
			
			// ƒê√≥ng dropdown khi click ngo√†i v√πng
			document.addEventListener('click', function (e) {
				if (!e.target.closest('.custom-dropdown')) {
					document.querySelectorAll('.custom-dropdown').forEach(dd => dd.classList.remove('open'));
				}
			});
			function handleGroupCheckboxLogic(groupName) {
				const checkboxes = document.querySelectorAll(`input[name="${groupName}"]`);
				const allCheckbox = Array.from(checkboxes).find(cb => cb.value === "all");
				
				checkboxes.forEach(cb => {
					cb.addEventListener("change", () => {
						if (cb.value === "all" && cb.checked) {
							checkboxes.forEach(c => {
								if (c !== cb) c.checked = false;
							});
							} else if (cb.value !== "all" && cb.checked) {
							allCheckbox.checked = false;
						}
						
						// Kh√¥ng checkbox n√†o ƒë∆∞·ª£c ch·ªçn ‚Üí b·∫≠t l·∫°i "T·∫•t c·∫£"
						const checkedCount = Array.from(checkboxes).filter(c => c.checked).length;
						if (checkedCount === 0) {
							allCheckbox.checked = true;
						}
						
						selectGroup(); // C·∫≠p nh·∫≠t
					});
				});
			}
			document.addEventListener("click", function (event) {
				const isDropdownButton = event.target.matches(".dropdown-btn");
				const dropdowns = document.querySelectorAll(".dropdown-content");
				
				dropdowns.forEach(dropdown => {
					const parent = dropdown.parentElement;
					if (!parent.contains(event.target) && !isDropdownButton) {
						dropdown.style.display = "none";
					}
				});
			});
			
			
			
		</script>
	</body>
</html>
